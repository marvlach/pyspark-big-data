# spark-submit query1.py csv rdd
# time elapsed 105.97846913337708
# spark history server 1.8 min

[
    ("2010", "03", 17595, 1),
    ("2010", "07", 17520, 2),
    ("2010", "05", 17338, 3),
    ("2011", "08", 17139, 1),
    ("2011", "05", 17050, 2),
    ("2011", "03", 16951, 3),
    ("2012", "08", 17696, 1),
    ("2012", "10", 17477, 2),
    ("2012", "05", 17391, 3),
    ("2013", "08", 17329, 1),
    ("2013", "07", 16714, 2),
    ("2013", "05", 16671, 3),
    ("2014", "07", 17456, 1),
    ("2014", "10", 17300, 2),
    ("2014", "12", 17076, 3),
    ("2015", "08", 19134, 1),
    ("2015", "10", 19065, 2),
    ("2015", "07", 18755, 3),
    ("2016", "08", 19834, 1),
    ("2016", "10", 19678, 2),
    ("2016", "07", 19343, 3),
    ("2017", "10", 20436, 1),
    ("2017", "08", 20127, 2),
    ("2017", "07", 20034, 3),
    ("2018", "05", 20277, 1),
    ("2018", "07", 19998, 2),
    ("2018", "10", 19851, 3),
    ("2019", "07", 19349, 1),
    ("2019", "08", 19094, 2),
    ("2019", "03", 18967, 3),
    ("2020", "01", 18512, 1),
    ("2020", "02", 17443, 2),
    ("2020", "07", 17257, 3),
    ("2021", "10", 19191, 1),
    ("2021", "07", 18954, 2),
    ("2021", "11", 18666, 3),
    ("2022", "05", 20784, 1),
    ("2022", "08", 20585, 2),
    ("2022", "06", 20418, 3),
    ("2023", "10", 20350, 1),
    ("2023", "08", 20345, 2),
    ("2023", "01", 20257, 3),
    ("2024", "01", 20015, 1),
    ("2024", "02", 18009, 2),
    ("2024", "03", 17186, 3),
]

# spark-submit query1.py parquet rdd
# time elapsed 56.669790744781494
# spark history server 1.0 min

[
    ("2010", "03", 17595, 1),
    ("2010", "07", 17520, 2),
    ("2010", "05", 17338, 3),
    ("2011", "08", 17139, 1),
    ("2011", "05", 17050, 2),
    ("2011", "03", 16951, 3),
    ("2012", "08", 17696, 1),
    ("2012", "10", 17477, 2),
    ("2012", "05", 17391, 3),
    ("2013", "08", 17329, 1),
    ("2013", "07", 16714, 2),
    ("2013", "05", 16671, 3),
    ("2014", "07", 17456, 1),
    ("2014", "10", 17300, 2),
    ("2014", "12", 17076, 3),
    ("2015", "08", 19134, 1),
    ("2015", "10", 19065, 2),
    ("2015", "07", 18755, 3),
    ("2016", "08", 19834, 1),
    ("2016", "10", 19678, 2),
    ("2016", "07", 19343, 3),
    ("2017", "10", 20436, 1),
    ("2017", "08", 20127, 2),
    ("2017", "07", 20034, 3),
    ("2018", "05", 20277, 1),
    ("2018", "07", 19998, 2),
    ("2018", "10", 19851, 3),
    ("2019", "07", 19349, 1),
    ("2019", "08", 19094, 2),
    ("2019", "03", 18967, 3),
    ("2020", "01", 18512, 1),
    ("2020", "02", 17443, 2),
    ("2020", "07", 17257, 3),
    ("2021", "10", 19191, 1),
    ("2021", "07", 18954, 2),
    ("2021", "11", 18666, 3),
    ("2022", "05", 20784, 1),
    ("2022", "08", 20585, 2),
    ("2022", "06", 20418, 3),
    ("2023", "10", 20350, 1),
    ("2023", "08", 20345, 2),
    ("2023", "01", 20257, 3),
    ("2024", "01", 20015, 1),
    ("2024", "02", 18009, 2),
    ("2024", "03", 17186, 3),
]

# spark-submit query1.py csv sql
# time elapsed 59.56702518463135
# spark history server 1.1 min

+----+-----+-----+----+
|year|month|count|rank|
+----+-----+-----+----+
|2010|   03|17595|   1|
|2010|   07|17520|   2|
|2010|   05|17338|   3|
|2011|   08|17139|   1|
|2011|   05|17050|   2|
|2011|   03|16951|   3|
|2012|   08|17696|   1|
|2012|   10|17477|   2|
|2012|   05|17391|   3|
|2013|   08|17329|   1|
|2013|   07|16714|   2|
|2013|   05|16671|   3|
|2014|   07|17456|   1|
|2014|   10|17300|   2|
|2014|   12|17076|   3|
|2015|   08|19134|   1|
|2015|   10|19065|   2|
|2015|   07|18755|   3|
|2016|   08|19834|   1|
|2016|   10|19678|   2|
|2016|   07|19343|   3|
|2017|   10|20436|   1|
|2017|   08|20127|   2|
|2017|   07|20034|   3|
|2018|   05|20277|   1|
|2018|   07|19998|   2|
|2018|   10|19851|   3|
|2019|   07|19349|   1|
|2019|   08|19094|   2|
|2019|   03|18967|   3|
|2020|   01|18512|   1|
|2020|   02|17443|   2|
|2020|   07|17257|   3|
|2021|   10|19191|   1|
|2021|   07|18954|   2|
|2021|   11|18666|   3|
|2022|   05|20784|   1|
|2022|   08|20585|   2|
|2022|   06|20418|   3|
|2023|   10|20350|   1|
|2023|   08|20345|   2|
|2023|   01|20257|   3|
|2024|   01|20015|   1|
|2024|   02|18009|   2|
|2024|   03|17186|   3|
+----+-----+-----+----+


# spark-submit query1.py parquet sql
# time elapsed 32.014612913131714
# spark history server 36 s

+----+-----+-----+----+
|year|month|count|rank|
+----+-----+-----+----+
|2010|   03|17595|   1|
|2010|   07|17520|   2|
|2010|   05|17338|   3|
|2011|   08|17139|   1|
|2011|   05|17050|   2|
|2011|   03|16951|   3|
|2012|   08|17696|   1|
|2012|   10|17477|   2|
|2012|   05|17391|   3|
|2013|   08|17329|   1|
|2013|   07|16714|   2|
|2013|   05|16671|   3|
|2014|   07|17456|   1|
|2014|   10|17300|   2|
|2014|   12|17076|   3|
|2015|   08|19134|   1|
|2015|   10|19065|   2|
|2015|   07|18755|   3|
|2016|   08|19834|   1|
|2016|   10|19678|   2|
|2016|   07|19343|   3|
|2017|   10|20436|   1|
|2017|   08|20127|   2|
|2017|   07|20034|   3|
|2018|   05|20277|   1|
|2018|   07|19998|   2|
|2018|   10|19851|   3|
|2019|   07|19349|   1|
|2019|   08|19094|   2|
|2019|   03|18967|   3|
|2020|   01|18512|   1|
|2020|   02|17443|   2|
|2020|   07|17257|   3|
|2021|   10|19191|   1|
|2021|   07|18954|   2|
|2021|   11|18666|   3|
|2022|   05|20784|   1|
|2022|   08|20585|   2|
|2022|   06|20418|   3|
|2023|   10|20350|   1|
|2023|   08|20345|   2|
|2023|   01|20257|   3|
|2024|   01|20015|   1|
|2024|   02|18009|   2|
|2024|   03|17186|   3|
+----+-----+-----+----+

# spark-submit query1.py csv df
# time elapsed 47.127848625183105
# spark history server 51 s

+----+-----+-----+----+
|year|month|count|rank|
+----+-----+-----+----+
|2010|   03|17595|   1|
|2010|   07|17520|   2|
|2010|   05|17338|   3|
|2011|   08|17139|   1|
|2011|   05|17050|   2|
|2011|   03|16951|   3|
|2012|   08|17696|   1|
|2012|   10|17477|   2|
|2012|   05|17391|   3|
|2013|   08|17329|   1|
|2013|   07|16714|   2|
|2013|   05|16671|   3|
|2014|   07|17456|   1|
|2014|   10|17300|   2|
|2014|   12|17076|   3|
|2015|   08|19134|   1|
|2015|   10|19065|   2|
|2015|   07|18755|   3|
|2016|   08|19834|   1|
|2016|   10|19678|   2|
|2016|   07|19343|   3|
|2017|   10|20436|   1|
|2017|   08|20127|   2|
|2017|   07|20034|   3|
|2018|   05|20277|   1|
|2018|   07|19998|   2|
|2018|   10|19851|   3|
|2019|   07|19349|   1|
|2019|   08|19094|   2|
|2019|   03|18967|   3|
|2020|   01|18512|   1|
|2020|   02|17443|   2|
|2020|   07|17257|   3|
|2021|   10|19191|   1|
|2021|   07|18954|   2|
|2021|   11|18666|   3|
|2022|   05|20784|   1|
|2022|   08|20585|   2|
|2022|   06|20418|   3|
|2023|   10|20350|   1|
|2023|   08|20345|   2|
|2023|   01|20257|   3|
|2024|   01|20015|   1|
|2024|   02|18009|   2|
|2024|   03|17186|   3|
+----+-----+-----+----+

# spark-submit query1.py parquet df
# time elapsed 32.33705401420593
# spark history server 36 s

+----+-----+-----+----+
|year|month|count|rank|
+----+-----+-----+----+
|2010|   03|17595|   1|
|2010|   07|17520|   2|
|2010|   05|17338|   3|
|2011|   08|17139|   1|
|2011|   05|17050|   2|
|2011|   03|16951|   3|
|2012|   08|17696|   1|
|2012|   10|17477|   2|
|2012|   05|17391|   3|
|2013|   08|17329|   1|
|2013|   07|16714|   2|
|2013|   05|16671|   3|
|2014|   07|17456|   1|
|2014|   10|17300|   2|
|2014|   12|17076|   3|
|2015|   08|19134|   1|
|2015|   10|19065|   2|
|2015|   07|18755|   3|
|2016|   08|19834|   1|
|2016|   10|19678|   2|
|2016|   07|19343|   3|
|2017|   10|20436|   1|
|2017|   08|20127|   2|
|2017|   07|20034|   3|
|2018|   05|20277|   1|
|2018|   07|19998|   2|
|2018|   10|19851|   3|
|2019|   07|19349|   1|
|2019|   08|19094|   2|
|2019|   03|18967|   3|
|2020|   01|18512|   1|
|2020|   02|17443|   2|
|2020|   07|17257|   3|
|2021|   10|19191|   1|
|2021|   07|18954|   2|
|2021|   11|18666|   3|
|2022|   05|20784|   1|
|2022|   08|20585|   2|
|2022|   06|20418|   3|
|2023|   10|20350|   1|
|2023|   08|20345|   2|
|2023|   01|20257|   3|
|2024|   01|20015|   1|
|2024|   02|18009|   2|
|2024|   03|17186|   3|
+----+-----+-----+----+