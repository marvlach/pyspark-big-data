# csv mr
# time elapsed 86.54161429405212
# spark history server 1.5 min
[
    ("2010", "03", 17595, 1),
    ("2010", "07", 17520, 2),
    ("2010", "05", 17338, 3),
    ("2011", "08", 17139, 1),
    ("2011", "05", 17050, 2),
    ("2011", "03", 16951, 3),
    ("2012", "08", 17696, 1),
    ("2012", "10", 17477, 2),
    ("2012", "05", 17391, 3),
    ("2013", "08", 17329, 1),
    ("2013", "07", 16714, 2),
    ("2013", "05", 16671, 3),
    ("2014", "07", 17456, 1),
    ("2014", "10", 17300, 2),
    ("2014", "12", 17076, 3),
    ("2015", "08", 19134, 1),
    ("2015", "10", 19065, 2),
    ("2015", "07", 18755, 3),
    ("2016", "08", 19834, 1),
    ("2016", "10", 19678, 2),
    ("2016", "07", 19343, 3),
    ("2017", "10", 20436, 1),
    ("2017", "08", 20127, 2),
    ("2017", "07", 20034, 3),
    ("2018", "05", 20277, 1),
    ("2018", "07", 19998, 2),
    ("2018", "10", 19851, 3),
    ("2019", "07", 19349, 1),
    ("2019", "08", 19094, 2),
    ("2019", "03", 18967, 3),
    ("2020", "01", 18512, 1),
    ("2020", "02", 17443, 2),
    ("2020", "07", 17257, 3),
    ("2021", "10", 19191, 1),
    ("2021", "07", 18954, 2),
    ("2021", "11", 18666, 3),
    ("2022", "05", 20784, 1),
    ("2022", "08", 20585, 2),
    ("2022", "06", 20418, 3),
    ("2023", "10", 20350, 1),
    ("2023", "08", 20345, 2),
    ("2023", "01", 20257, 3),
    ("2024", "01", 20015, 1),
    ("2024", "02", 18009, 2),
    ("2024", "03", 17186, 3),
]

# parquet mr 
# time elapsed 56.676196575164795
# spark history server 1.0 min
[
    ("2010", "03", 17595, 1),
    ("2010", "07", 17520, 2),
    ("2010", "05", 17338, 3),
    ("2011", "08", 17139, 1),
    ("2011", "05", 17050, 2),
    ("2011", "03", 16951, 3),
    ("2012", "08", 17696, 1),
    ("2012", "10", 17477, 2),
    ("2012", "05", 17391, 3),
    ("2013", "08", 17329, 1),
    ("2013", "07", 16714, 2),
    ("2013", "05", 16671, 3),
    ("2014", "07", 17456, 1),
    ("2014", "10", 17300, 2),
    ("2014", "12", 17076, 3),
    ("2015", "08", 19134, 1),
    ("2015", "10", 19065, 2),
    ("2015", "07", 18755, 3),
    ("2016", "08", 19834, 1),
    ("2016", "10", 19678, 2),
    ("2016", "07", 19343, 3),
    ("2017", "10", 20436, 1),
    ("2017", "08", 20127, 2),
    ("2017", "07", 20034, 3),
    ("2018", "05", 20277, 1),
    ("2018", "07", 19998, 2),
    ("2018", "10", 19851, 3),
    ("2019", "07", 19349, 1),
    ("2019", "08", 19094, 2),
    ("2019", "03", 18967, 3),
    ("2020", "01", 18512, 1),
    ("2020", "02", 17443, 2),
    ("2020", "07", 17257, 3),
    ("2021", "10", 19191, 1),
    ("2021", "07", 18954, 2),
    ("2021", "11", 18666, 3),
    ("2022", "05", 20784, 1),
    ("2022", "08", 20585, 2),
    ("2022", "06", 20418, 3),
    ("2023", "10", 20350, 1),
    ("2023", "08", 20345, 2),
    ("2023", "01", 20257, 3),
    ("2024", "01", 20015, 1),
    ("2024", "02", 18009, 2),
    ("2024", "03", 17186, 3),
]

# csv sql
# time elapsed 59.2303581237793
# spark history server 1.1 min
+-----+----+-----+----+
|month|year|count|rank|
+-----+----+-----+----+
|   03|2010|17595|   1|
|   07|2010|17520|   2|
|   05|2010|17338|   3|
|   08|2011|17139|   1|
|   05|2011|17050|   2|
|   03|2011|16951|   3|
|   08|2012|17696|   1|
|   10|2012|17477|   2|
|   05|2012|17391|   3|
|   08|2013|17329|   1|
|   07|2013|16714|   2|
|   05|2013|16671|   3|
|   07|2014|17456|   1|
|   10|2014|17300|   2|
|   12|2014|17076|   3|
|   08|2015|19134|   1|
|   10|2015|19065|   2|
|   07|2015|18755|   3|
|   08|2016|19834|   1|
|   10|2016|19678|   2|
|   07|2016|19343|   3|
|   10|2017|20436|   1|
|   08|2017|20127|   2|
|   07|2017|20034|   3|
|   05|2018|20277|   1|
|   07|2018|19998|   2|
|   10|2018|19851|   3|
|   07|2019|19349|   1|
|   08|2019|19094|   2|
|   03|2019|18967|   3|
|   01|2020|18512|   1|
|   02|2020|17443|   2|
|   07|2020|17257|   3|
|   10|2021|19191|   1|
|   07|2021|18954|   2|
|   11|2021|18666|   3|
|   05|2022|20784|   1|
|   08|2022|20585|   2|
|   06|2022|20418|   3|
|   10|2023|20350|   1|
|   08|2023|20345|   2|
|   01|2023|20257|   3|
|   01|2024|20015|   1|
|   02|2024|18009|   2|
|   03|2024|17186|   3|
+-----+----+-----+----+

# parquet sql
# time elapsed 38.80563521385193
# spark history server 44 s
+-----+----+-----+----+
|month|year|count|rank|
+-----+----+-----+----+
|   03|2010|17595|   1|
|   07|2010|17520|   2|
|   05|2010|17338|   3|
|   08|2011|17139|   1|
|   05|2011|17050|   2|
|   03|2011|16951|   3|
|   08|2012|17696|   1|
|   10|2012|17477|   2|
|   05|2012|17391|   3|
|   08|2013|17329|   1|
|   07|2013|16714|   2|
|   05|2013|16671|   3|
|   07|2014|17456|   1|
|   10|2014|17300|   2|
|   12|2014|17076|   3|
|   08|2015|19134|   1|
|   10|2015|19065|   2|
|   07|2015|18755|   3|
|   08|2016|19834|   1|
|   10|2016|19678|   2|
|   07|2016|19343|   3|
|   10|2017|20436|   1|
|   08|2017|20127|   2|
|   07|2017|20034|   3|
|   05|2018|20277|   1|
|   07|2018|19998|   2|
|   10|2018|19851|   3|
|   07|2019|19349|   1|
|   08|2019|19094|   2|
|   03|2019|18967|   3|
|   01|2020|18512|   1|
|   02|2020|17443|   2|
|   07|2020|17257|   3|
|   10|2021|19191|   1|
|   07|2021|18954|   2|
|   11|2021|18666|   3|
|   05|2022|20784|   1|
|   08|2022|20585|   2|
|   06|2022|20418|   3|
|   10|2023|20350|   1|
|   08|2023|20345|   2|
|   01|2023|20257|   3|
|   01|2024|20015|   1|
|   02|2024|18009|   2|
|   03|2024|17186|   3|
+-----+----+-----+----+