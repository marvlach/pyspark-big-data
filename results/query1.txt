# spark-submit query1.py csv rdd
# time elapsed 89.06969714164734
# spark history server 1.6 min

[
    ("2010", "01", 19520, 1),
    ("2010", "03", 18131, 2),
    ("2010", "07", 17857, 3),
    ("2011", "01", 18141, 1),
    ("2011", "07", 17283, 2),
    ("2011", "10", 17034, 3),
    ("2012", "01", 17954, 1),
    ("2012", "08", 17661, 2),
    ("2012", "05", 17502, 3),
    ("2013", "08", 17441, 1),
    ("2013", "01", 16828, 2),
    ("2013", "07", 16645, 3),
    ("2014", "10", 17331, 1),
    ("2014", "07", 17258, 2),
    ("2014", "12", 17198, 3),
    ("2015", "10", 19221, 1),
    ("2015", "08", 19011, 2),
    ("2015", "07", 18709, 3),
    ("2016", "10", 19660, 1),
    ("2016", "08", 19496, 2),
    ("2016", "07", 19450, 3),
    ("2017", "10", 20437, 1),
    ("2017", "07", 20199, 2),
    ("2017", "01", 19849, 3),
    ("2018", "05", 19976, 1),
    ("2018", "07", 19879, 2),
    ("2018", "08", 19765, 3),
    ("2019", "07", 19126, 1),
    ("2019", "08", 18987, 2),
    ("2019", "03", 18865, 3),
    ("2020", "01", 18542, 1),
    ("2020", "02", 17272, 2),
    ("2020", "05", 17219, 3),
    ("2021", "10", 19326, 1),
    ("2021", "07", 18672, 2),
    ("2021", "08", 18387, 3),
    ("2022", "05", 20450, 1),
    ("2022", "10", 20313, 2),
    ("2022", "06", 20255, 3),
    ("2023", "10", 20029, 1),
    ("2023", "08", 20024, 2),
    ("2023", "01", 19902, 3),
    ("2024", "01", 18762, 1),
    ("2024", "02", 17214, 2),
    ("2024", "03", 16009, 3),
]


# spark-submit query1.py parquet rdd
# time elapsed 55.688615798950195
# spark history server 59 s

[
    ("2010", "01", 19520, 1),
    ("2010", "03", 18131, 2),
    ("2010", "07", 17857, 3),
    ("2011", "01", 18141, 1),
    ("2011", "07", 17283, 2),
    ("2011", "10", 17034, 3),
    ("2012", "01", 17954, 1),
    ("2012", "08", 17661, 2),
    ("2012", "05", 17502, 3),
    ("2013", "08", 17441, 1),
    ("2013", "01", 16828, 2),
    ("2013", "07", 16645, 3),
    ("2014", "10", 17331, 1),
    ("2014", "07", 17258, 2),
    ("2014", "12", 17198, 3),
    ("2015", "10", 19221, 1),
    ("2015", "08", 19011, 2),
    ("2015", "07", 18709, 3),
    ("2016", "10", 19660, 1),
    ("2016", "08", 19496, 2),
    ("2016", "07", 19450, 3),
    ("2017", "10", 20437, 1),
    ("2017", "07", 20199, 2),
    ("2017", "01", 19849, 3),
    ("2018", "05", 19976, 1),
    ("2018", "07", 19879, 2),
    ("2018", "08", 19765, 3),
    ("2019", "07", 19126, 1),
    ("2019", "08", 18987, 2),
    ("2019", "03", 18865, 3),
    ("2020", "01", 18542, 1),
    ("2020", "02", 17272, 2),
    ("2020", "05", 17219, 3),
    ("2021", "10", 19326, 1),
    ("2021", "07", 18672, 2),
    ("2021", "08", 18387, 3),
    ("2022", "05", 20450, 1),
    ("2022", "10", 20313, 2),
    ("2022", "06", 20255, 3),
    ("2023", "10", 20029, 1),
    ("2023", "08", 20024, 2),
    ("2023", "01", 19902, 3),
    ("2024", "01", 18762, 1),
    ("2024", "02", 17214, 2),
    ("2024", "03", 16009, 3),
]


# spark-submit query1.py csv sql
# time elapsed 75.43615484237671
# spark history server 1.3 min

+----+-----+-----+----+
|year|month|count|rank|
+----+-----+-----+----+
|2010|   01|19520|   1|
|2010|   03|18131|   2|
|2010|   07|17857|   3|
|2011|   01|18141|   1|
|2011|   07|17283|   2|
|2011|   10|17034|   3|
|2012|   01|17954|   1|
|2012|   08|17661|   2|
|2012|   05|17502|   3|
|2013|   08|17441|   1|
|2013|   01|16828|   2|
|2013|   07|16645|   3|
|2014|   10|17331|   1|
|2014|   07|17258|   2|
|2014|   12|17198|   3|
|2015|   10|19221|   1|
|2015|   08|19011|   2|
|2015|   07|18709|   3|
|2016|   10|19660|   1|
|2016|   08|19496|   2|
|2016|   07|19450|   3|
|2017|   10|20437|   1|
|2017|   07|20199|   2|
|2017|   01|19849|   3|
|2018|   05|19976|   1|
|2018|   07|19879|   2|
|2018|   08|19765|   3|
|2019|   07|19126|   1|
|2019|   08|18987|   2|
|2019|   03|18865|   3|
|2020|   01|18542|   1|
|2020|   02|17272|   2|
|2020|   05|17219|   3|
|2021|   10|19326|   1|
|2021|   07|18672|   2|
|2021|   08|18387|   3|
|2022|   05|20450|   1|
|2022|   10|20313|   2|
|2022|   06|20255|   3|
|2023|   10|20029|   1|
|2023|   08|20024|   2|
|2023|   01|19902|   3|
|2024|   01|18762|   1|
|2024|   02|17214|   2|
|2024|   03|16009|   3|
+----+-----+-----+----+


# spark-submit query1.py parquet sql
# time elapsed 22.723820447921753
# spark history server 27 s

+----+-----+-----+----+
|year|month|count|rank|
+----+-----+-----+----+
|2010|   01|19520|   1|
|2010|   03|18131|   2|
|2010|   07|17857|   3|
|2011|   01|18141|   1|
|2011|   07|17283|   2|
|2011|   10|17034|   3|
|2012|   01|17954|   1|
|2012|   08|17661|   2|
|2012|   05|17502|   3|
|2013|   08|17441|   1|
|2013|   01|16828|   2|
|2013|   07|16645|   3|
|2014|   10|17331|   1|
|2014|   07|17258|   2|
|2014|   12|17198|   3|
|2015|   10|19221|   1|
|2015|   08|19011|   2|
|2015|   07|18709|   3|
|2016|   10|19660|   1|
|2016|   08|19496|   2|
|2016|   07|19450|   3|
|2017|   10|20437|   1|
|2017|   07|20199|   2|
|2017|   01|19849|   3|
|2018|   05|19976|   1|
|2018|   07|19879|   2|
|2018|   08|19765|   3|
|2019|   07|19126|   1|
|2019|   08|18987|   2|
|2019|   03|18865|   3|
|2020|   01|18542|   1|
|2020|   02|17272|   2|
|2020|   05|17219|   3|
|2021|   10|19326|   1|
|2021|   07|18672|   2|
|2021|   08|18387|   3|
|2022|   05|20450|   1|
|2022|   10|20313|   2|
|2022|   06|20255|   3|
|2023|   10|20029|   1|
|2023|   08|20024|   2|
|2023|   01|19902|   3|
|2024|   01|18762|   1|
|2024|   02|17214|   2|
|2024|   03|16009|   3|
+----+-----+-----+----+

# spark-submit query1.py csv df
# time elapsed 56.556700706481934
# spark history server 1.0 min

+----+-----+-----+----+
|year|month|count|rank|
+----+-----+-----+----+
|2010|   01|19520|   1|
|2010|   03|18131|   2|
|2010|   07|17857|   3|
|2011|   01|18141|   1|
|2011|   07|17283|   2|
|2011|   10|17034|   3|
|2012|   01|17954|   1|
|2012|   08|17661|   2|
|2012|   05|17502|   3|
|2013|   08|17441|   1|
|2013|   01|16828|   2|
|2013|   07|16645|   3|
|2014|   10|17331|   1|
|2014|   07|17258|   2|
|2014|   12|17198|   3|
|2015|   10|19221|   1|
|2015|   08|19011|   2|
|2015|   07|18709|   3|
|2016|   10|19660|   1|
|2016|   08|19496|   2|
|2016|   07|19450|   3|
|2017|   10|20437|   1|
|2017|   07|20199|   2|
|2017|   01|19849|   3|
|2018|   05|19976|   1|
|2018|   07|19879|   2|
|2018|   08|19765|   3|
|2019|   07|19126|   1|
|2019|   08|18987|   2|
|2019|   03|18865|   3|
|2020|   01|18542|   1|
|2020|   02|17272|   2|
|2020|   05|17219|   3|
|2021|   10|19326|   1|
|2021|   07|18672|   2|
|2021|   08|18387|   3|
|2022|   05|20450|   1|
|2022|   10|20313|   2|
|2022|   06|20255|   3|
|2023|   10|20029|   1|
|2023|   08|20024|   2|
|2023|   01|19902|   3|
|2024|   01|18762|   1|
|2024|   02|17214|   2|
|2024|   03|16009|   3|
+----+-----+-----+----+

# spark-submit query1.py parquet df
# time elapsed 32.29404067993164
# spark history server 37 s

+----+-----+-----+----+
|year|month|count|rank|
+----+-----+-----+----+
|2010|   01|19520|   1|
|2010|   03|18131|   2|
|2010|   07|17857|   3|
|2011|   01|18141|   1|
|2011|   07|17283|   2|
|2011|   10|17034|   3|
|2012|   01|17954|   1|
|2012|   08|17661|   2|
|2012|   05|17502|   3|
|2013|   08|17441|   1|
|2013|   01|16828|   2|
|2013|   07|16645|   3|
|2014|   10|17331|   1|
|2014|   07|17258|   2|
|2014|   12|17198|   3|
|2015|   10|19221|   1|
|2015|   08|19011|   2|
|2015|   07|18709|   3|
|2016|   10|19660|   1|
|2016|   08|19496|   2|
|2016|   07|19450|   3|
|2017|   10|20437|   1|
|2017|   07|20199|   2|
|2017|   01|19849|   3|
|2018|   05|19976|   1|
|2018|   07|19879|   2|
|2018|   08|19765|   3|
|2019|   07|19126|   1|
|2019|   08|18987|   2|
|2019|   03|18865|   3|
|2020|   01|18542|   1|
|2020|   02|17272|   2|
|2020|   05|17219|   3|
|2021|   10|19326|   1|
|2021|   07|18672|   2|
|2021|   08|18387|   3|
|2022|   05|20450|   1|
|2022|   10|20313|   2|
|2022|   06|20255|   3|
|2023|   10|20029|   1|
|2023|   08|20024|   2|
|2023|   01|19902|   3|
|2024|   01|18762|   1|
|2024|   02|17214|   2|
|2024|   03|16009|   3|
+----+-----+-----+----+